WEBVTT

00:00.000 --> 00:00.000
La fórmula resultante es "=SUMAR.SI.CONJUNTO(UNIDADES;PRODUCTO;C3;PRECIO;D3)", y tras pulsar Intro nos informa de que hay 13 unidades en total.

00:03.000 --> 00:09.740
Para finalizar esta serie de vídeos, vamos a mostrar las funciones que podemos utilizar para contar, sumar y promediar datos...

00:09.880 --> 00:11.600
... cuando tenemos más de un criterio.

00:12.180 --> 00:22.520
Como en el vídeo anterior, disponemos de un libro de ejemplo en cuya Hoja1 tenemos una lista de productos con nombre, unidades y precio. 

00:22.960 --> 00:26.940
También tenemos un porcentaje de IVA en la celda F1.

00:27.220 --> 00:33.140
Todos estos datos están debidamente nombrados como podemos comprobar desplegando el cuadro de nombres.  

00:35.000 --> 00:44.420
Los nombres "PRODUCTO", "UNIDADES" y "PRECIO" nos facilitarán la creación rápida de fórmulas.

00:46.140 --> 00:55.400
En la Hoja2, hemos establecido dos celdas para introducir las condiciones que aplicaremos en función del nombre de producto o del precio del mismo.

00:56.580 --> 01:02.500
Estas celdas, la C3 y la D3, han sido sombreadas en color azul pálido.

01:03.180 --> 01:11.940
En la actualidad los criterios establecidos son que el nombre del producto debe comenzar por "SX" y el precio ser superior a 2500.

01:13.140 --> 01:24.860
En las filas 6 a 8, en el vídeo anterior hemos utilizado las funciones CONTAR.SI, SUMAR.SI y PROMEDIO.SI

01:25.280 --> 01:29.400
para responder a una serie de preguntas sobre los datos de la Hoja1.

01:29.940 --> 01:36.340
Comentábamos al finalizar el video que estas funciones tienen la limitación de que sólo admiten un criterio.

01:36.860 --> 01:46.620
En consecuencia, en este ejemplo no puedo saber cuantos productos de la serie "SX" tienen al mismo tiempo un precio superior a 2500.

01:47.660 --> 01:56.620
Antiguamente, la única manera de resolver esta cuestión era crear una columna auxiliar en la tabla de datos para que reflejasen la combinación de diferentes criterios...

01:57.200 --> 02:04.920
... y esa columna sería el intervalo donde se comprobaría el criterio establecido por las funciones.

02:05.780 --> 02:13.960
Otra posibilidad que había era la de usar fórmulas matriciales, cuestión esotérica que representa un verdadero dolor de cabeza.

02:14.460 --> 02:19.520
Afortunadamente, desde hace algún tiempo existen funciones análogas a las ya tratadas

02:19.520 --> 02:24.960
que permiten contar, sumar y promediar los datos que cumplan varios criterios.

02:25.220 --> 02:33.580
Estas funciones son CONTAR.SI.CONJUNTO, SUMAR.SI.CONJUNTO y PROMEDIO.SI.CONJUNTO.

02:34.860 --> 02:43.760
Vamos a mostrar su uso en las celdas desde C11 hasta C13, que han sido combinadas horizontalmente con las celdas de la columna D contigua.

02:44.300 --> 02:48.800
Al igual que en el ejemplo anterior, hemos sombreado en amarillo las celdas donde escribiremos las fórmulas

02:49.240 --> 02:53.240
y al lado en la columna E, hemos escrito el nombre de las funciones que utilizaremos. 

02:53.480 --> 02:58.280
Estas celdas con el nombre de las funciones están destacadas en letra blanca sobre fondo rojo oscuro.

02:58.900 --> 03:08.800
En primer lugar vamos a contar los productos que cumplen simultáneamente los dos criterios establecidos en las celdas C3 y D3...

03:09.740 --> 03:14.300
... es decir, productos que comienzan por "SX" con precio superior a 2500.

03:15.000 --> 03:28.080
Hacemos clic en la celda C11. Y comenazamos a escribir la fórmula "=CONTAR.SI.CONJUNTO("

03:29.340 --> 03:37.680
Los dos primeros argumentos son el rango "PRODUCTO" y la celda C3.

03:40.420 --> 03:45.720
Escribimos "PRODUCTO", seguido de punto y coma y seleccionamos la celda C3.

03:46.680 --> 03:51.920
Hasta aquí la fórmula es exactamente igual a lo que habríamos hecho con CONTAR.SI.

03:53.220 --> 03:56.360
En CONTAR.SI ya no podríamos añadir más criterios.

03:56.360 --> 04:04.900
En cambio, ahora, con CONTAR.SI.CONJUNTO, podemos seguir ampliando la fórmula con más parejas de intervalo y criterio.

04:06.000 --> 04:14.840
El segundo par de argumentos, por tanto, será comprobar en el rango PRECIO que se cumpla el criterio establecido en la celda D3 (ser superior a 2500)

04:15.940 --> 04:32.460
Seguimos escribiendo la fórmula con un punto y coma, seguido del nombre de rango "PRECIO", otro punto y coma, seleccionamos la celda D3 y cerramos el paréntesis.

04:33.440 --> 04:47.920
Y ya tenemos completa nuestra fórmula. La fórmula resultante es "=CONTAR.SI.CONJUNTO(PRODUCTO;C3;PRECIO;D3)".  

04:48.720 --> 04:54.620
Pulsamos Intro y el resultado es 1.  Vamos a comprobarlo en la Hoja1.

04:56.120 --> 05:11.720
En la Hoja1, observamos que de todos los productos cuyo nombre comienza por "SX", tan sólo hay uno con un precio superior a 2500.

05:13.560 --> 05:15.320
Regresamos a la Hoja2.

05:18.120 --> 05:22.420
Ahora sumaremos las unidades de los productos que cumplen estos dos criterios.

05:23.180 --> 05:32.580
En la celda C12 escribimos "=SUMAR.SI.CONJUNTO(".

05:33.500 --> 05:38.060
Esta función es muy parecida al SUMAR.SI, pero el orden de los argumentos cambia.

05:38.580 --> 05:46.000
Si bien en SUMAR.SI, el rango a sumar es el tercer argumento, que además es opcional y se puede omitir si coincide con el primero,

05:46.660 --> 05:53.380
el que especifica el rango donde comprobar el criterio, en SUMAR.SI.CONJUNTO, el rango a sumar es el primero,

05:53.480 --> 05:58.480
e irá seguido por diferentes parejas de intervalo y criterio para cada una de las condiciones a evaluar.

05:59.080 --> 06:06.720
Esta alteración en el orden de los argumentos puede confundir un poco al principio, pero a la que hayáis practicado un par de veces con esta función, ya lo tendréis por la mano.

06:07.340 --> 06:15.320
Entonces seguimos completando la fórmula, escribiendo el nombre del rango "UNIDADES", que es lo que queremos sumar...

06:16.420 --> 06:38.160
... y completamos con las parejas de condiciones, escribiendo ";PRODUCTO;C3;PRECIO;D3)".

06:42.920 --> 06:49.120
Tras pulsar Intro se nos informa de que hay 13 unidades en total

06:53.040 --> 06:57.420
Ahora queremos saber el precio medio de estos productos que cumplen ambas condiciones.

06:57.740 --> 07:01.580
Para ello usaremos la función PROMEDIO.SI.CONJUNTO.

07:02.020 --> 07:09.340
Esta función es clónica de SUMAR.SI.CONJUNTO, y tan sólo cambiará en que en vez de sumar estaremos promediando.

07:10.100 --> 07:50.600
En la celda C13 escribimos "=PROMEDIO.SI.CONJUNTO(PRECIO" -que es el dato que queremos promediar- ";PRODUCTO;C3;PRECIO;D3)"

07:53.800 --> 08:05.000
Cerramos paréntesis y el resultado es 2870, que coincide con el precio del único producto que cumple ambas condiciones.

08:07.560 --> 08:19.020
Hemos construido una especie de plantilla que, simplemente cambiando los criterios establecidos en las celdas C3 y D3, responderá a todas estas preguntas...

08:20.840 --> 08:28.340
... tanto referidas a uno cualquiera de los dos criterios, gracias a CONTAR.SI, SUMAR.SI y PROMEDIO.SI...

08:29.580 --> 08:39.800
... como a los productos que cumplan ambos criterios simultáneamente, usando CONTAR.SI.CONJUNTO, SUMAR.SI.CONJUNTO y PROMEDIO.SI.CONJUNTO.

08:41.940 --> 08:53.600
Por ejemplo, para que se efectúe el cálculo para todos los productos, podemos establecer en C3, el criterio "*" (asterisco) que se referirá a cualquier nombre....

08:55.540 --> 09:02.680
... y en D3, podemos escribir ">0", que también cubrirá todos los precios.

09:03.500 --> 09:09.920
En este caso, comprobamos que los resultados coinciden en todos los casos, porque se están obteniendo para todos los productos.

09:11.640 --> 09:16.520
Y aquí finalizamos esta serie de tres vídeos que os han mostrado como efectuar 

09:16.520 --> 09:19.740
cálculos condicionales sobre vuestras tablas de datos.

09:20.240 --> 09:24.000
Nunca más tendréis problemas para responder a preguntas del tipo...

09:24.780 --> 09:29.360
... "¿Cuántas personas trabajan en el departamento de producción de la factoría X?",

09:29.780 --> 09:34.920
"¿Cuál es el coste salarial del personal administrativo de más de cincuenta años?",

09:35.300 --> 09:39.320
"¿Cuántos alumnos han aprobado el curso en diferentes convocatorias?"

09:40.220 --> 09:41.920
Creemos que podéis haberlo disfrutado.

09:42.240 --> 09:44.420
Muchas gracias por acompañarnos hasta aquí.
