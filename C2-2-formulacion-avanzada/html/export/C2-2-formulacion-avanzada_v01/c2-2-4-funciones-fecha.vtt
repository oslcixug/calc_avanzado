WEBVTT

00:04.260 --> 00:10.820
En esta ocasión dedicamos el vídeo a trabajar con las principales funciones de fecha disponibles en LibreOffice Calc.

00:11.560 --> 00:19.060
También aprovecharemos esta oportunidad para mostraros algunos trucos y sugerencias que resultarán muy útiles cuando debáis trabajar con fechas y horas.

00:19.680 --> 00:26.380
Disponemos de un documento de ejemplo, donde se han resaltado sobre fondo rojo oscuro las funciones que utilizaremos...

00:26.920 --> 00:35.980
... y sobre fondo amarillo las celdas donde escribiremos fórmulas o efectuaremos algún cambio relevante.

00:36.660 --> 00:41.880
En primer lugar, muchas veces necesitamos controlar el día actual.

00:42.580 --> 00:50.020
Imaginad, por ejemplo, unos datos con una fecha de vencimiento.  Y cada vez que abramos esa hoja tener calculados los días que faltan hasta el vencimiento.

00:50.980 --> 00:53.760
Para saber el día actual, usamos la función HOY.

00:54.860 --> 00:58.560
La función HOY es tan simple, que ni siquiera hay que pasarle argumentos.

00:58.880 --> 01:10.320
Así que nos situamos en la celda B1 y escribimos la fórmula "=HOY()".  Aunque no haya nada entre ellos, los paréntesis son imprescindibles.

01:10.860 --> 01:20.720
Al pulsar Intro, se nos muestra la fecha de hoy.  Al haberla introducido con una función, si mañana volvemos a abrir este mismo libro, la fecha habrá cambiado.

01:21.620 --> 01:31.120
Muy a menudo necesitaremos introducir la fecha de hoy, de forma que quede fija.

01:32.180 --> 01:38.420
En vez de escribirla, como es habitual, en formato dd/mm/aa, hay el atajo de teclado que vamos a mostrar.

01:38.980 --> 01:44.960
Activamos la celda C1 y simplemente tecleamos Ctrl más el símbolo "," (coma)

01:47.940 --> 01:56.120
Se ha introducido la fecha de hoy, pero observando la barra de fórmulas, comprobamos que esta fecha se ha introducido directamente.  

01:56.120 --> 02:00.860
No es resultado de ningún cálculo ni función, no es ninguna variable, simplemente es una constante.

02:03.140 --> 02:08.940
Hay personas que no sólo necesitan saber en qué dia están, sino también en que momento viven.  

02:09.280 --> 02:13.540
Para eso hay una función análoga a la de HOY, que se llama AHORA.

02:14.760 --> 02:23.640
En la celda B2 escribimos la fórmula "=AHORA()" también sin ningún argumento entre los paréntesis.

02:24.620 --> 02:27.800
El resultado nos muestra la fecha y la hora actual.

02:28.600 --> 02:34.860
Esta hora se irá modificando cada vez que se recalcule la hoja y eso ocurre cada vez que introducimos algún dato.

02:35.060 --> 02:37.340
Lo iremos comprobando a lo largo del video,

02:37.620 --> 02:47.200
Si queremos actualizar la hora sin introducir nada en la hoja, basta con pulsar la tecla de función F9 que provoca el recálculo manual de la hoja.

02:48.880 --> 02:53.120
También hay un atajo de teclado para introducir este dato de forma que quede invariable.

02:54.140 --> 03:02.240
Situados en la celda C2, tecleamos Ctrl y Mayúsculas más el símbolo "," (coma).

03:08.580 --> 03:14.300
Podemos ver en la barra de fórmulas que el dato introducido es una constante.

03:16.240 --> 03:22.400
En ocasiones nos puede interesar conocer el número de día, el número de mes o el número de año de una fecha dada.

03:23.160 --> 03:28.360
Las funciones que nos van a permitir obtener estos datos, se llaman respectivamente DIA, MES y AÑO.

03:29.320 --> 03:37.580
Estas funciones necesitan un argumento, que es simplemente una fecha, o una referencia a una celda que contenga un año...

03:37.580 --> 03:41.700
... o un simple número que pueda ser interpretado como una fecha, como veremos más adelante.

03:42.600 --> 03:47.820
Aprovecharemos esta práctica para ver maneras de introducir una fecha dentro de una fórmula.

03:49.260 --> 03:57.280
Como argumento de fecha no se puede introducir como dia/mes/año porque Calc interpreta que estamos efectuando una división.

03:58.440 --> 04:03.400
Si lo intodujésemos como dia-mes-año, estaría interpretando como una resta.

04:04.200 --> 04:12.120
Cuando necesitemos una fecha dentro de una fórmula, la introduciremos entrecomillada en formato "dia/mes/año".  

04:13.140 --> 04:21.660
Como separador, en Calc necesariamente ha de ser la barra inclinada. Otros programas admiten el guión como separador entre día, mes y año.

04:23.140 --> 04:28.720
Recomendamos introducir el año en cuatro dígitos para evitar posibles confusiones, pues para hacer esto mismo

04:28.720 --> 04:35.880
otros programas de hoja de cálculo exigen que el formato sea como año/mes/dia.

04:36.560 --> 04:53.820
Entonces, nos situamos en la celda B4 y escribimos la fórmula "=DIA("17/3/2015")".

04:56.780 --> 05:03.460
El resultado es 17 y a la derecha se muestra la fórmula introducida.

05:05.480 --> 05:10.780
Esto es porque hemos utilizado aquí una función especial que muestra las fórmulas.

05:15.800 --> 05:21.240
Podemos, también, pasar como argumento una función o un cálculo que devuelvan una fecha.

05:21.780 --> 05:39.820
En la celda B5 escribimos "=MES(HOY())".

05:40.380 --> 05:46.240
Estamos anidando la función HOY que devuelve una fecha como argumento para la función MES.

05:51.560 --> 05:55.840
Hemos dicho que también podemos pasar como argumento un cálculo que devuelva una fecha.

05:56.500 --> 06:17.100
Entonces, en la celda B6 escribimos "=AÑO("15/12/2017"+30)"

06:17.840 --> 06:25.740
Lo que estamos pasando como argumento es la fecha resultante de añadir 30 días al 15 de diciembre del 2017,

06:27.320 --> 06:34.200
Por consiguiente el resultado nos muestra 2018, pues la fecha ya se va al año siguiente.

06:36.200 --> 06:39.980
Por si las dudas, en seguida mostraremos como efectuar cálculos con fechas.

06:41.180 --> 06:48.420
Ya hemos comprobado que podemos trocear fechas entre su número de día, su número de mes y su número de año.

06:49.880 --> 06:55.340
También hay otra función que permite obtener una fecha a partir de un número de día, un número de mes y un número de año.

06:55.440 --> 07:02.900
Se trata de la función FECHA y como argumentos recibe, en este orden ¡y esto es importante¡, un año, un mes y un día.

07:03.720 --> 07:21.000
En la celda B8 escribImos la fórmula "=FECHA(2017;12;31)".

07:22.700 --> 07:27.540
El resultado es el correspondiente al 31 de diciembre de 2017.

07:29.960 --> 07:34.520
Al ver estas funciones quizás os estéis preguntando que utilidad podemos obtener con ellas.

07:35.240 --> 07:39.160
Alguien que haya trabajado en administración de compras o facturación lo verá en seguida.

07:39.480 --> 07:45.880
A la pregunta "¿Cuándo paga este cliente?", una respuesta puede ser "A 30 días fecha factura, el día 20".

07:46.120 --> 07:54.640
Esto quiere decir que si el vencimiento teórico fuese el 25 de abril, como el cliente paga sólo el día 20, el vencimiento real se iría al 20 de mayo.

07:55.080 --> 08:01.640
Estas funciones DIA, MES, AÑO y FECHA nos permiten poder efectuar este tipo de cálculos.

08:03.700 --> 08:09.180
Para entender como se efectuan los cálculos con fechas, debemos ser muy conscientes de un concepto importante.

08:10.120 --> 08:15.040
Y es que una fecha no es nada más que un número formateado de una forma "rara".

08:16.060 --> 08:21.760
En ocasiones os encontraréis que esperando obtener una fecha, el resultado os muestra un número, o viceversa.

08:22.480 --> 08:25.720
Lo más habitual es que penséis que os habéis equivocado con el cálculo,

08:26.000 --> 08:32.000
pero si tenéis presente que un fecha es un número, lo único que necesitáis es aplicar al resultado el formato esperado.

08:32.780 --> 08:41.720
Vamos a demostrarlo.  En la celda C10, hay una función HOY que nos devuelve la fecha actual.

08:43.960 --> 08:53.840
Seleccionamos la celda y aplicamos un formato de número desde el menú Formato, y en el submenú "Formato numérico" escoger "General".

08:56.580 --> 09:01.880
Vemos el número de día que corresponde a la fecha de hoy, el 43044.

09:03.400 --> 09:11.000
¿Y qué significa este número?  Pues simplemente el número de días transcurridos desde el 31/12/1899.

09:12.320 --> 09:21.100
Demostración.  En la celda C11 tenemos el número 1.  Aplicaremos a esta celda el formato de fecha.  

09:21.680 --> 09:27.640
Como queremos el año con cuatro dígitos, desde el menú contextual abrimos el cuadro de diálogo "Formato de celdas".

09:30.620 --> 09:44.380
En la pestaña "Números", seleccionamos "Categoría" Fecha y en la lista de Formatos, escogemos el formato de fecha con cuatro dígitos de año.

09:45.640 --> 09:53.480
Tras aceptar, podemos comprobar que el número 1 corresponde al 31 de diciembre de 1899.

09:57.000 --> 10:00.220
Para finalizar, un poco de cálculos con fechas y horas.

10:01.080 --> 10:08.100
Ahora que ya tenemos claro que una fecha es un número, el efectuar cálculos con fechas es tan fácil como operar aritméticamente entre ellas.

10:09.200 --> 10:18.700
En las filas 15 y 16 tenemos un par de datos consistentes en una fecha inicial y una fecha final.  Vamos a calcular los días transcurridos entre ambas.

10:19.460 --> 10:33.240
En la celda C15 escribimos la fórmula "=B15" (que contiene la fecha final) "-A15" (que contiene la fecha inicial).

10:33.880 --> 10:41.400
El resultado nos muestra 235, que es el número de dias transcurridos desde el 15 de marzo hasta el hoy.

10:43.480 --> 10:58.460
Copiamos la fórmula a la celda C16 y comprobamos que desde el día 15 de mayo, en cambio, tan sólo transcurrieron 174 días.

11:01.240 --> 11:05.860
Con las horas procederemos igual, pero comentaremos un par de detalles que os pueden evitar confusiones.

11:06.280 --> 11:15.780
En las filas 21 y 22 tenemos horas de inicio y final de un turno de trabajo y vamos a calcular la duración entre ambas.

11:17.420 --> 11:36.960
En la celda C21, escribimos "=B21-A21" y el resultado nos muestra las 4 horas y media transcurridas desde las 9:30 hasta las 14:00.

11:40.160 --> 11:51.600
Al copiar la fórmula a la celda C22, nos muestra que entre las 22:00 hasta las 02:00 han transcurrido 4 horas.

11:52.540 --> 11:58.640
En otros programas esto daría un resultado erróneo porque no manejan tan bien fechas y horas como lo hace LibreOffice Calc.  

11:59.320 --> 12:06.900
Para ser estrictos, el programa no sabe que las 2 de la madrugada están después de las 10 de la noche anterior.  

12:07.260 --> 12:16.880
Así que sería mucho más preciso introducir la hora final como 26 horas, es decir, 2 horas después de las 24:00.

12:22.540 --> 12:29.020
Esto funciona, pero es más correcto poner las 26:00 horas.

12:29.660 --> 12:36.740
Haciéndolo así, se seguirán mostrando las 2 de la madrugada, pero internamente Calc ya sabrá que estamos hablando del día siguiente.

12:37.040 --> 12:41.520
Esto nos asegurará que otros cálculos posteriores puedan salir perfectamente.

12:42.820 --> 12:47.640
Para acabar, ¿qué ocurre cuando multiplicamos la duración resultante por un precio hora?

12:48.960 --> 13:13.920
En la celda E21 escribimos "=D21*C21"  y el resultado es absolutamente inverosímil.

13:14.860 --> 13:20.360
El problema es que si un día es una unidad, una hora es una fracción de la unidad.

13:21.200 --> 13:27.020
Si el precio estuviese en forma de precio por día, habría funcionado.

13:28.220 --> 13:37.600
La explicación la entenderemos si damos formato de número general a todo el rango desde A21 hasta C22,

13:37.940 --> 13:44.220
Así comprobaremos el número interno para los formatos de hora que tenemos.

13:45.120 --> 13:49.960
Lo hacemos desde el menú Formato, "Formato numérico", "General"

13:52.400 --> 14:03.160
Ahora podemos ver que lo que hemos introducido como horas, en forma decimal no són más que fracciones de la unidad.

14:04.520 --> 14:09.460
Ese es el motivo de que el cálculo de multiplicar por el precio-hora no funcione bien.

14:10.800 --> 14:15.280
Deshacemos el último cambio de formato para volver al formato de hora.

14:16.100 --> 14:24.580
La solución está en escribir la fórmula de E21 multiplicando además por las 24 horas que tiene el día.

14:25.080 --> 14:32.520
Editamos la celda E21 y añadimos "*24". 

14:34.180 --> 14:43.160
Ahora sí que ya funciona correctamente. Copiamos la fórmula a la celda E22 y ya hemos completado el cálculo para toda la tabla.

14:46.100 --> 14:51.340
Estamos seguros de que con estas funciones y las sugerencias de cálculo que os hemos transmitido,

14:51.820 --> 14:56.540
no tendréis ningún problema cuando debáis trabajar con el tiempo en vuestras hojas de cálculo.

14:56.940 --> 15:06.380
Hay muchas otras funciones para trabajar con fechas que podréis explorar desde la lista de funciones en la barra lateral seleccionando la categoría "Fecha".

15:08.280 --> 15:12.560
Esperamos que os haya resultado interesante este vídeo.

15:13.760 --> 15:15.280
Muchas gracias por vuestra atención.
